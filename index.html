 <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>KPI Board (Online Shared)</title>
  <link rel="stylesheet" href="styles.css" />
  <link rel="manifest" href="manifest.webmanifest">
<meta name="theme-color" content="#131722">

  <!-- –°—Ç–∏–ª–∏ –∏ –∏–∫–æ–Ω–∫–∏ -->
  <link rel="stylesheet" href="styles.css" />
  <link rel="manifest" href="manifest.webmanifest" />
  <link rel="icon" href="icons/icon-192.png" type="image/png" />
  <meta name="theme-color" content="#131722" />
</head>

<body>
<header>
  <h1>KPI Board</h1>
  <span class="tag">Firebase Shared</span>
</header>

<main>
  <aside class="side">
    <div class="group">
      <button id="addKpi">–î–æ–±–∞–≤–∏—Ç—å KPI</button>
      <button id="addWeek">–î–æ–±–∞–≤–∏—Ç—å –Ω–µ–¥–µ–ª—é</button>
      <button id="delRow">–£–¥–∞–ª–∏—Ç—å —Å—Ç—Ä–æ–∫—É</button>
    </div>
  </aside>

  <section class="grid-wrap">
    <table id="kpiTable">
      <thead>
        <tr id="theadRow">
          <th class="col-kpi">KPI name</th>
          <th class="col-target">Target</th>
        </tr>
      </thead>
      <tbody id="tbody"></tbody>
    </table>

    <footer class="usersbar">
      <div id="users"></div>
      <div class="addUser">
        <input id="newUserName" placeholder="–î–æ–±–∞–≤–∏—Ç—å –∏–º—è..." />
        <button id="addUser">+</button>
      </div>
    </footer>
  </section>
</main>

<!-- ==== Firebase + Auth + Firestore (–µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –º–æ–¥—É–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç) ==== -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
  import { 
    getAuth, onAuthStateChanged, signInWithEmailAndPassword, 
    createUserWithEmailAndPassword, signOut 
  } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
  import { 
    getFirestore, doc, getDoc, setDoc, onSnapshot, enableIndexedDbPersistence 
  } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

  // –ö–æ–Ω—Ñ–∏–≥ —Ç–≤–æ–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
  const firebaseConfig = {
    apiKey: "AIzaSyCb92dCbGD4H_YHPGt9SSPukDc7zlk9CpU",
    authDomain: "kpi-board-139b1.firebaseapp.com",
    projectId: "kpi-board-139b1",
    storageBucket: "kpi-board-139b1.firebasestorage.app",
    messagingSenderId: "805537122913",
    appId: "1:805537122913:web:69457a3a36173f5720b820"
  };

  // Init
  const app  = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db   = getFirestore(app);

  // –û—Ñ–ª–∞–π–Ω-–∫—ç—à Firestore (–Ω–µ —Å—Ç—Ä–∞—à–Ω–æ, –µ—Å–ª–∏ —É–∂–µ –≤–∫–ª—é—á—ë–Ω)
  enableIndexedDbPersistence(db).catch(() => {});
// ===== –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ (–¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç—ã –∏ –¥–æ–ª–∂–Ω–æ—Å—Ç–∏) =====
const DEPARTMENTS = [
  "Administration",
  "Accounting",
  "Dispatching"
];

const POSITIONS_BY_DEPT = {
  "Administration": [
    "Director",
    "Team Leader",
    "Driver Evaluator",
    "Capacity Planner",
    "Driver Manager",
    "Driver Administrator"
  ],
  "Accounting": [
    "Team Leader",
    "Manager",
    "Payroll"
  ],
  "Dispatching": [
    "Team Leader",
    "Dispo FTL",
    "Dispo XTL/ODC"
  ]
};

// –ö–∞–∫–∏–µ –¥–æ–ª–∂–Ω–æ—Å—Ç–∏ –ø–æ–ª—É—á–∞—é—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –ø—Ä–∞–≤–∞
const DIRECTOR_POSITIONS = ["Director"];
const LEADER_POSITIONS   = ["Team Leader"];

// –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è –≤—ã–ø–∞–¥–∞—é—â–∏—Ö —Å–ø–∏—Å–∫–æ–≤ –∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–æ–ª–∏
function buildOptions(list, placeholder) {
  return `<option value="" disabled selected>${placeholder}</option>` +
         list.map(v => `<option value="${v}">${v}</option>`).join("");
}
function roleFromPosition(position){
  if (DIRECTOR_POSITIONS.includes(position)) return "director";
  if (LEADER_POSITIONS.includes(position))   return "leader";
  return "member";
}

  // –ü—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ–º –≤ –≥–ª–æ–±–∞–ª –¥–ª—è app.js
  window.__FB_AUTH = auth;
  window.__FB_DB   = db;
  window.__fbDoc    = doc;
  window.__fbGetDoc = getDoc;
  window.__fbSetDoc = setDoc;
  window.__fbSnap   = onSnapshot;
  window.__fbLogout = async () => { try { await signOut(auth); } catch(e){ alert("Logout error: "+e.message); } };

  window.showLoginScreen = function(){
  if (document.querySelector('#authBox')) return;
  const box = document.createElement('div');
  box.id = 'authBox';
  box.style = "position:fixed;inset:0;display:flex;align-items:center;justify-content:center;z-index:100000;background:rgba(2,6,10,0.7)";
  box.innerHTML = `
    <div style="width:460px;background:#0f1620;border:1px solid #223;padding:20px;border-radius:12px;color:#e8eef5;box-shadow:0 10px 40px rgba(0,0,0,.5)">
      <h3 style="margin-top:0">KPI Board ‚Äî –í—Ö–æ–¥ / –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h3>

      <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px">
        <input id="authFirst"  type="text" placeholder="First name"  style="grid-column:1/2;padding:10px;border-radius:8px;background:#0f1824;border:1px solid #2b3648;color:#e8eef5"/>
        <input id="authLast"   type="text" placeholder="Last name"   style="grid-column:2/3;padding:10px;border-radius:8px;background:#0f1824;border:1px solid #2b3648;color:#e8eef5"/>

        <select id="authDept"  style="grid-column:1/3;padding:10px;border-radius:8px;background:#0f1824;border:1px solid #2b3648;color:#e8eef5"></select>
        <select id="authPos"   style="grid-column:1/3;padding:10px;border-radius:8px;background:#0f1824;border:1px solid #2b3648;color:#e8eef5"></select>

        <input id="authEmail"  type="email"    placeholder="Email"   style="grid-column:1/3;padding:10px;border-radius:8px;background:#0f1824;border:1px solid #2b3648;color:#e8eef5"/>
        <input id="authPass"   type="password" placeholder="Password"style="grid-column:1/3;padding:10px;border-radius:8px;background:#0f1824;border:1px solid #2b3648;color:#e8eef5"/>
  <header>
    <h1>KPI Board</h1>
    <span class="tag">Firebase Shared</span>
  </header>

  <main>
    <aside class="side">
      <div class="group">
        <button id="addKpi">–î–æ–±–∞–≤–∏—Ç—å KPI</button>
        <button id="addWeek">–î–æ–±–∞–≤–∏—Ç—å –Ω–µ–¥–µ–ª—é</button>
        <button id="delRow">–£–¥–∞–ª–∏—Ç—å —Å—Ç—Ä–æ–∫—É</button>
      </div>
    </aside>

    <section class="grid-wrap">
      <table id="kpiTable">
        <thead>
          <tr id="theadRow">
            <th class="col-kpi">KPI name</th>
            <th class="col-target">Target</th>
          </tr>
        </thead>
        <tbody id="tbody"></tbody>
      </table>

      <footer class="usersbar">
        <div id="users"></div>
        <div class="addUser">
          <input id="newUserName" placeholder="–î–æ–±–∞–≤–∏—Ç—å –∏–º—è..." />
          <button id="addUser">+</button>
        </div>
      </footer>
    </section>
  </main>

  <!-- ==== Firebase + Auth + Firestore (–µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –º–æ–¥—É–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç) ==== -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import {
      getAuth, onAuthStateChanged, signInWithEmailAndPassword,
      createUserWithEmailAndPassword, signOut
    } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
    import {
      getFirestore, doc, getDoc, setDoc, onSnapshot, enableIndexedDbPersistence
    } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

    // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Firebase –ø—Ä–æ–µ–∫—Ç–∞
    const firebaseConfig = {
      apiKey: "AIzaSyCb92dCbGD4H_YHPGt9SSPukDc7zlk9CpU",
      authDomain: "kpi-board-139b1.firebaseapp.com",
      projectId: "kpi-board-139b1",
      storageBucket: "kpi-board-139b1.firebasestorage.app",
      messagingSenderId: "805537122913",
      appId: "1:805537122913:web:69457a3a36173f5720b820"
    };

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Firebase
    const app  = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db   = getFirestore(app);
    enableIndexedDbPersistence(db).catch(() => {});

    // ===== –î–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç—ã –∏ –¥–æ–ª–∂–Ω–æ—Å—Ç–∏ =====
    const DEPARTMENTS = ["Administration", "Accounting", "Dispatching"];
    const POSITIONS_BY_DEPT = {
      "Administration": ["Director", "Team Leader", "Driver Evaluator", "Capacity Planner", "Driver Manager", "Driver Administrator"],
      "Accounting": ["Team Leader", "Manager", "Payroll"],
      "Dispatching": ["Team Leader", "Dispo FTL", "Dispo XTL/ODC"]
    };
    const DIRECTOR_POSITIONS = ["Director"];
    const LEADER_POSITIONS   = ["Team Leader"];

    function buildOptions(list, placeholder) {
      return `<option value="" disabled selected>${placeholder}</option>` +
        list.map(v => `<option value="${v}">${v}</option>`).join("");
    }
    function roleFromPosition(position){
      if (DIRECTOR_POSITIONS.includes(position)) return "director";
      if (LEADER_POSITIONS.includes(position))   return "leader";
      return "member";
    }

      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:10px">
        <button id="btnLogin"     style="padding:8px 12px;border-radius:8px">–í–æ–π—Ç–∏</button>
        <button id="btnRegister"  style="padding:8px 12px;border-radius:8px">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
      </div>
      <div style="margin-top:8px;font-size:12px;color:#a8b6c9">
        –ü—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –≤—ã –±—É–¥–µ—Ç–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç.
      </div>
    </div>
  `;
  document.body.appendChild(box);

  // –ó–∞–ø–æ–ª–Ω—è–µ–º –≤—ã–ø–∞–¥–∞—é—â–∏–µ —Å–ø–∏—Å–∫–∏
  const selDept  = box.querySelector('#authDept');
  const selPos   = box.querySelector('#authPos');
  selDept.innerHTML = buildOptions(DEPARTMENTS, "Select department");
  selPos.innerHTML  = buildOptions([], "Select position");
  selDept.onchange = () => {
    const list = POSITIONS_BY_DEPT[selDept.value] || [];
    selPos.innerHTML = buildOptions(list, "Select position");
  };

  // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
box.querySelector('#btnRegister').onclick = async () => {
  const first = box.querySelector('#authFirst').value.trim();
  const last  = box.querySelector('#authLast').value.trim();
  const dept  = selDept.value;
  const pos   = selPos.value;
  const email = box.querySelector('#authEmail').value.trim();
  const pass  = box.querySelector('#authPass').value;

  if (!first || !last || !dept || !pos || !email || !pass){
    alert("–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è"); return;
  }

  try {
    const cred = await createUserWithEmailAndPassword(auth, email, pass);
    const uid  = cred.user.uid;
    const displayName = `${first} ${last}`;
    const role = roleFromPosition(pos);

    await setDoc(doc(db, "users", uid), {
      displayName, email, department: dept, position: pos, role, createdAt: Date.now()
    // ----- –ü—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ–º –≤ –≥–ª–æ–±–∞–ª –¥–ª—è app.js -----
    window.__FB_AUTH = auth;
    window.__FB_DB   = db;
    window.__fbDoc    = doc;
    window.__fbGetDoc = getDoc;
    window.__fbSetDoc = setDoc;
    window.__fbSnap   = onSnapshot;
    window.__fbLogout = async () => { try { await signOut(auth); } catch(e){ alert("Logout error: " + e.message); } };

    // ===== –≠–∫—Ä–∞–Ω –ª–æ–≥–∏–Ω–∞ / —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ =====
    window.showLoginScreen = function(){
      if (document.querySelector('#authBox')) return;

      const box = document.createElement('div');
      box.id = 'authBox';
      box.style = "position:fixed;inset:0;display:flex;align-items:center;justify-content:center;z-index:100000;background:rgba(2,6,10,0.7)";
      box.innerHTML = `
        <div style="width:460px;background:#0f1620;border:1px solid #223;padding:20px;border-radius:12px;color:#e8eef5;box-shadow:0 10px 40px rgba(0,0,0,.5)">
          <h3 style="margin-top:0">KPI Board ‚Äî –í—Ö–æ–¥ / –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h3>

          <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px">
            <input id="authFirst"  type="text" placeholder="First name"  style="grid-column:1/2;padding:10px;border-radius:8px;background:#0f1824;border:1px solid #2b3648;color:#e8eef5"/>
            <input id="authLast"   type="text" placeholder="Last name"   style="grid-column:2/3;padding:10px;border-radius:8px;background:#0f1824;border:1px solid #2b3648;color:#e8eef5"/>

            <select id="authDept"  style="grid-column:1/3;padding:10px;border-radius:8px;background:#0f1824;border:1px solid #2b3648;color:#e8eef5"></select>
            <select id="authPos"   style="grid-column:1/3;padding:10px;border-radius:8px;background:#0f1824;border:1px solid #2b3648;color:#e8eef5"></select>

            <input id="authEmail"  type="email" placeholder="Email" style="grid-column:1/3;padding:10px;border-radius:8px;background:#0f1824;border:1px solid #2b3648;color:#e8eef5"/>
            <input id="authPass"   type="password" placeholder="Password" style="grid-column:1/3;padding:10px;border-radius:8px;background:#0f1824;border:1px solid #2b3648;color:#e8eef5"/>
          </div>

          <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:10px">
            <button id="btnLogin"     style="padding:8px 12px;border-radius:8px">–í–æ–π—Ç–∏</button>
            <button id="btnRegister"  style="padding:8px 12px;border-radius:8px">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
          </div>
          <div style="margin-top:8px;font-size:12px;color:#a8b6c9">
            –ü—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –≤—ã –±—É–¥–µ—Ç–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç.
          </div>
        </div>
      `;
      document.body.appendChild(box);

      const selDept = box.querySelector('#authDept');
      const selPos  = box.querySelector('#authPos');
      selDept.innerHTML = buildOptions(DEPARTMENTS, "Select department");
      selPos.innerHTML  = buildOptions([], "Select position");
      selDept.onchange = () => {
        const list = POSITIONS_BY_DEPT[selDept.value] || [];
        selPos.innerHTML = buildOptions(list, "Select position");
      };

      // ===== –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è =====
      box.querySelector('#btnRegister').onclick = async () => {
        const first = box.querySelector('#authFirst').value.trim();
        const last  = box.querySelector('#authLast').value.trim();
        const dept  = selDept.value;
        const pos   = selPos.value;
        const email = box.querySelector('#authEmail').value.trim();
        const pass  = box.querySelector('#authPass').value;

        if (!first || !last || !dept || !pos || !email || !pass) {
          alert("–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è");
          return;
        }

        try {
          const cred = await createUserWithEmailAndPassword(auth, email, pass);
          const uid  = cred.user.uid;
          const displayName = `${first} ${last}`;
          const role = roleFromPosition(pos);

          await setDoc(doc(db, "users", uid), {
            displayName, email, department: dept, position: pos, role, createdAt: Date.now()
          });

          window.currentUserProfile = { displayName, email, department: dept, position: pos, role };

          window.hideLoginScreen && window.hideLoginScreen();
          window.dispatchEvent(new CustomEvent('fbAuthChanged', { detail: auth.currentUser }));
        } catch (err) {
          alert("–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: " + err.message);
        }
      };

      // ===== –í—Ö–æ–¥ =====
      box.querySelector('#btnLogin').onclick = async () => {
        const email = box.querySelector('#authEmail').value.trim();
        const pass  = box.querySelector('#authPass').value;

        try {
          const cred = await signInWithEmailAndPassword(auth, email, pass);
          const snap = await getDoc(doc(db, "users", cred.user.uid));
          if (snap.exists()) window.currentUserProfile = snap.data();

          window.hideLoginScreen && window.hideLoginScreen();
          window.dispatchEvent(new CustomEvent('fbAuthChanged', { detail: auth.currentUser }));
        } catch (err) {
          alert("–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞: " + err.message);
        }
      };
    };

    window.hideLoginScreen = function() {
      document.querySelector('#authBox')?.remove();
    };

    // ===== –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è =====
    async function loadUserProfile(uid){
      try {
        const snap = await getDoc(doc(db, "users", uid));
        if (snap.exists()) {
          window.currentUserProfile = snap.data();
        } else {
          window.currentUserProfile = null;
          console.warn("–ü—Ä–æ—Ñ–∏–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω –¥–ª—è uid:", uid);
        }
      } catch(e){
        console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è:", e);
        window.currentUserProfile = null;
      }
    }

    // ===== –°–ª—É—à–∞–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é =====
    onAuthStateChanged(auth, async (user) => {
      if (user) {
        await loadUserProfile(user.uid);
      } else {
        window.currentUserProfile = null;
      }
      window.dispatchEvent(new CustomEvent('fbAuthChanged', { detail: user || null }));
    });
  </script>

    window.currentUserProfile = { displayName, email, department: dept, position: pos, role };

    // üîΩ –°—Ä–∞–∑—É –∑–∞–∫—Ä—ã–≤–∞–µ–º –æ–∫–Ω–æ –∏ —Ñ–æ—Ä—Å–∏—Ä—É–µ–º –∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    window.hideLoginScreen && window.hideLoginScreen();
    window.dispatchEvent(new CustomEvent('fbAuthChanged', { detail: auth.currentUser }));
  } catch(err){
    alert("–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: " + err.message);
  }
};


 // –í—Ö–æ–¥
box.querySelector('#btnLogin').onclick = async () => {
  const email = box.querySelector('#authEmail').value.trim();
  const pass  = box.querySelector('#authPass').value;
  try {
    const cred = await signInWithEmailAndPassword(auth, email, pass);

    // –ü–æ–¥—Ç—è–Ω–µ–º –ø—Ä–æ—Ñ–∏–ª—å –Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π (–µ—Å–ª–∏ onAuthStateChanged –ø—Ä–∏–¥—ë—Ç —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π)
    try {
      const snap = await getDoc(doc(db, "users", cred.user.uid));
      if (snap.exists()) window.currentUserProfile = snap.data();
    } catch (e) { /* –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ */ }

    // üîΩ –ó–∞–∫—Ä—ã–≤–∞–µ–º –æ–∫–Ω–æ –∏ —Ñ–æ—Ä—Å–∏—Ä—É–µ–º –∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    window.hideLoginScreen && window.hideLoginScreen();
    window.dispatchEvent(new CustomEvent('fbAuthChanged', { detail: auth.currentUser }));
  } catch(err){
    alert('–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞: ' + err.message);
  }
};



async function loadUserProfile(uid){
  try{
    const snap = await getDoc(doc(db, "users", uid));
    if (snap.exists()) {
      window.currentUserProfile = snap.data();
    } else {
      window.currentUserProfile = null;
      console.warn("–ü—Ä–æ—Ñ–∏–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω –¥–ª—è uid:", uid);
    }
  }catch(e){
    console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è:", e);
    window.currentUserProfile = null;
  }
}

onAuthStateChanged(auth, async (user) => {
  if (user) {
    await loadUserProfile(user.uid);
  } else {
    window.currentUserProfile = null;
  }
  window.dispatchEvent(new CustomEvent('fbAuthChanged', { detail: user || null }));
});

</script>

<!-- ==== –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ==== -->
<script src="app.js"></script>

<!-- ==== –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è SW —Ç–æ–ª—å–∫–æ –Ω–∞ https/localhost (—á—Ç–æ–±—ã –Ω–µ —Ä—É–≥–∞–ª—Å—è –Ω–∞ file://) ==== -->
<script>
  if ('serviceWorker' in navigator && (location.protocol === 'https:' || location.hostname === 'localhost')) {
    navigator.serviceWorker.register('./sw.js').catch(console.error);
  }
</script>
  <!-- ==== –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ==== -->
  <script src="app.js"></script>

  <!-- ==== Service Worker –¥–ª—è PWA ==== -->
  <script>
    if ('serviceWorker' in navigator && (location.protocol === 'https:' || location.hostname === 'localhost')) {
      navigator.serviceWorker.register('./sw.js').catch(console.error);
    }
  </script>
</body>
</html>
